import { encryptString } from '@/lib/utils';
import { getDMSansFonts } from '@/server/utils/utils';
import { type Font, type Template } from '@pdfme/common';
import { generate } from '@pdfme/generator';
import { barcodes, image, line, rectangle, text } from '@pdfme/schemas';
import { format } from 'date-fns';
import { es } from 'date-fns/locale';

export function generateTicketTemplate(first_word: string): Template {
  const accentColor = process.env.NEXT_PUBLIC_ACCENT_COLOR;
  const accentText = process.env.NEXT_PUBLIC_TEXT_ACCENT_COLOR;
  const offset = (first_word.length + 1) * 9.7;
  return {
    schemas: [
      [
        {
          name: 'rect_main',
          type: 'rectangle',
          position: { x: 32.81, y: 158.99 },
          width: 245.27,
          height: 274.64,
          rotate: 0,
          opacity: 1,
          borderWidth: 1.5,
          borderColor: '#000000',
          color: '#ffffff',
          readOnly: true,
          radius: 13,
          required: false,
          content: '',
        },
        {
          name: 'rect_header',
          type: 'rectangle',
          position: { x: 32.81, y: 70.67 },
          width: 245.27,
          height: 79.9,
          rotate: 0,
          opacity: 1,
          borderWidth: 1.5,
          borderColor: '#000000',
          color: accentColor,
          readOnly: true,
          radius: 13,
          required: false,
          content: '',
        },
        {
          name: 'rect_location',
          type: 'rectangle',
          position: { x: 32.81, y: 132.15 },
          width: 245.27,
          height: 37.57,
          rotate: 0,
          opacity: 1,
          borderWidth: 1.5,
          borderColor: '#000000',
          color: '#a3a3a3',
          readOnly: true,
          radius: 0,
          required: false,
          content: '',
        },
        {
          name: 'eventName',
          type: 'text',
          content: 'Expo Bolita',
          position: { x: 47, y: 82.64 },
          width: 227.81,
          height: 17.2,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 48,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentText,
          fontName: 'DMSans-Bold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'eventDate',
          type: 'text',
          content: 'Domingo 15 de junio 2025 - 12:00 hrs.',
          position: { x: 47, y: 109.75 },
          width: 227.28,
          height: 17.2,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 32,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentText,
          fontName: 'DMSans-Bold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'eventLocation',
          type: 'text',
          content: 'Avenida Juan B. Justo 1576',
          position: { x: 47, y: 143.86 },
          width: 202.14,
          height: 17.2,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 32,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-SemiBold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'locationSVG',
          type: 'image',
          content:
            'data:image/jpeg;base64,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',
          position: { x: 249.42, y: 141.25 },
          width: 19.84,
          height: 19.84,
          rotate: 0,
          opacity: 1,
          required: false,
          readOnly: true,
        },
        {
          name: 'fullName_title',
          type: 'text',
          content: 'Nombre completo del titular del ticket:',
          position: { x: 47, y: 185 },
          width: 201.08,
          height: 10.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-Light',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: false,
          readOnly: true,
        },
        {
          name: 'fullName',
          type: 'text',
          content: 'Yosimar Yotún',
          position: { x: 47, y: 196.98 },
          width: 223.04,
          height: 19.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 46.25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentColor,
          fontName: 'DMSans-SemiBold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'dni_title',
          type: 'text',
          content: 'DNI del titular del ticket:',
          position: { x: 47, y: 273 },
          width: 201.08,
          height: 10.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-Light',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: false,
          readOnly: true,
        },
        {
          name: 'dni',
          type: 'text',
          content: '38.092.954',
          position: { x: 47, y: 285.37 },
          width: 225.69,
          height: 19.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 46.25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentColor,
          fontName: 'DMSans-SemiBold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'ticketType_title',
          type: 'text',
          content: 'Tipo de entrada:',
          position: { x: 47, y: 362 },
          width: 201.08,
          height: 10.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-Light',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: false,
          readOnly: true,
        },
        {
          name: 'ticketType',
          type: 'text',
          content: 'ticketType',
          position: { x: 47, y: 374.38 },
          width: 225.69,
          height: 19.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 46.25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentColor,
          fontName: 'DMSans-SemiBold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'barcode',
          type: 'qrcode',
          content: 'This is Code 128!',
          position: { x: 109.5, y: 450.23 },
          backgroundColor: '#e4e4e4',
          barColor: accentColor,
          textColor: '#000000',
          includetext: false,
          width: 90,
          height: 90,
          rotate: 0,
          opacity: 1,
          required: true,
          readOnly: false,
        },
        {
          name: 'footer',
          type: 'text',
          content: 'FOOTER',
          position: { x: 33, y: 559.74 },
          width: 243.95,
          height: 40.75,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-SemiBold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'emissionDate_title',
          type: 'text',
          content: 'Fecha de emisión del ticket:',
          position: { x: 33.11, y: 614.67 },
          width: 201.08,
          height: 10.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-Light',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: false,
          readOnly: true,
        },
        {
          name: 'emissionDate',
          type: 'text',
          content: '17/03/2025 23:46',
          position: { x: 33, y: 627.05 },
          width: 243,
          height: 19.05,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 46.25,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentColor,
          fontName: 'DMSans-SemiBold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'name_first_word',
          type: 'text',
          content: 'Expo',
          position: { x: 32.81, y: 23.54 },
          width: 223.31,
          height: 32.81,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 56,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: accentColor,
          fontName: 'DMSans-Bold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
        {
          name: 'name_second_word',
          type: 'text',
          content: 'Expo',
          position: { x: 32.81 + offset, y: 23.54 },
          width: 223.31,
          height: 32.81,
          rotate: 0,
          alignment: 'left',
          verticalAlignment: 'top',
          fontSize: 56,
          lineHeight: 1,
          characterSpacing: 0,
          fontColor: '#000000',
          fontName: 'DMSans-Bold',
          backgroundColor: '',
          opacity: 1,
          strikethrough: false,
          underline: false,
          required: true,
          readOnly: false,
        },
      ],
    ],
    basePdf:
      'data:application/pdf;base64,JVBERi0xLjEKMSAwIG9iago8PAogICAgL1R5cGUgL0NhdGFsb2cKICAgIC9QYWdlcyAyIDAgUgo+PgplbmRvYmoKMiAwIG9iago8PAogICAgL1R5cGUgL1BhZ2VzCiAgICAvS2lkcyBbIDYgMCBSIF0KICAgIC9Db3VudCAxCj4+CmVuZG9iagozIDAgb2JqCjw8CiAgICAvWE9iamVjdCA8PAogICAgICAgIC9JMSA0IDAgUgogICAgICAgIC9JMiA1IDAgUgogICAgPj4KPj4KZW5kb2JqCjQgMCBvYmoKPDwKICAgIC9UeXBlIC9YT2JqZWN0CiAgICAvU3VidHlwZSAvSW1hZ2UKICAgIC9CaXRzUGVyQ29tcG9uZW50IDgKICAgIC9Db2xvclNwYWNlIC9EZXZpY2VSR0IKICAgIC9IZWlnaHQgMTkxOQogICAgL1dpZHRoIDg4MgogICAgL0ZpbHRlciAvRmxhdGVEZWNvZGUKICAgIC9MZW5ndGggNDk1NQo+PgpzdHJlYW0KeJzswQEBAAAAgJD/q+sICgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA24MDAgAAAAAh/183JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcBoqXJ4QplbmRzdHJlYW0KZW5kb2JqCjYgMCBvYmoKPDwKICAgIC9UeXBlIC9QYWdlCiAgICAvUGFyZW50IDIgMCBSCiAgICAvUmVzb3VyY2VzIDMgMCBSCiAgICAvTWVkaWFCb3ggWyAwIDAgODgyIDE5MTkgXQogICAgL0Fubm90cyBbICBdCiAgICAvQ29udGVudHMgNyAwIFIKPj4KZW5kb2JqCjcgMCBvYmoKPDwKICAgIC9GaWx0ZXIgL0ZsYXRlRGVjb2RlCiAgICAvTGVuZ3RoIDQxCj4+CnN0cmVhbQp4nCtUsLAwUjAAQkNLQ0swIzlXQd/TUMElX0EhkKsQh7wRVB4AqX0NHgplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCA4CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAwOSAwMDAwMCBuIAowMDAwMDAwMDY2IDAwMDAwIG4gCjAwMDAwMDAxMzcgMDAwMDAgbiAKMDAwMDAwMDIxNyAwMDAwMCBuIAowMDAwMDA1Mzc1IDAwMDAwIG4gCjAwMDAwMTA1MzQgMDAwMDAgbiAKMDAwMDAxMDY3OCAwMDAwMCBuIAp0cmFpbGVyCjw8CiAgICAvUm9vdCAxIDAgUgogICAgL1NpemUgOAo+PgpzdGFydHhyZWYKMTA3OTgKJSVFT0YK',
    pdfmeVersion: '5.4.1',
  };
}

interface GenerateTicketProps {
  eventName: string;
  eventDate: string;
  eventLocation: string;
  fullName: string;
  dni: string;
  id: string;
  createdAt: string;
  ticketType: string;
}

export async function generatePdf(ticket: GenerateTicketProps) {
  if (!ticket) {
    throw new Error('Ticket no encontrado');
  }

  const formattedTime = format(ticket.eventDate, 'HH:mm');
  const formattedDate = format(ticket.eventDate, 'PPPP', {
    locale: es,
  });

  const normalizedDni = Number.isNaN(Number(ticket.dni))
    ? ticket.dni
    : Number(ticket.dni).toLocaleString('es-ES');

  const [firstWord, ...rest] = process.env.NEXT_PUBLIC_INSTANCE_NAME!.split(' ');
  const template = generateTicketTemplate(firstWord);

  const inputs = [
    {
      eventName: ticket.eventName,
      eventDate: `${formattedDate} - ${formattedTime}`,
      eventLocation: ticket.eventLocation,
      fullName: ticket.fullName,
      dni: normalizedDni,
      barcode: encryptString(ticket.id),
      footer: `Para cualquier duda, reclamo o consulta comunicarse vía mail a ${process.env.INSTANCE_CONTACT_EMAIL}.\nMás información en ${process.env.INSTANCE_WEB_URL}.`,
      emissionDate: format(ticket.createdAt, 'dd/MM/yyyy HH:mm'),
      ticketType: ticket.ticketType,
      name_first_word: firstWord,
      name_second_word: rest.join(' '),
    },
  ];

  const { fontBold, fontSemiBold, fontLight } = await getDMSansFonts();

  const font: Font = {
    'DMSans-Bold': {
      data: fontBold, // Provide the buffer instead of a string path
    },
    'DMSans-SemiBold': {
      data: fontSemiBold, // Provide the buffer instead of a string path
      fallback: true,
    },
    'DMSans-Light': {
      data: fontLight, // Provide the buffer instead of a string path
    },
  };

  const plugins = {
    text,
    line,
    image,
    rectangle,
    barcodes: barcodes.qrcode,
  };

  const pdf = await generate({
    template,
    inputs,
    plugins,
    options: {
      font,
    },
  });

  const blob = new Blob([pdf.buffer as BlobPart], {
    type: 'application/pdf',
  });

  return blob;
}
